<%= title @product_name %>

<h3><%= @product_name %></h3><br/>
<h4>(Product Stock + Pending Stock) : </h4>
<h4>Total Stock (WS + Retail + Pending) : </h4>

<%# Overall Stats Display %>
<div style="margin-top: 50px;">
<%= form_tag({:action => "summary" }, {:method => "get"}) do %>

	<%= render "partials/overall_stats", supply_display_class: "" %>

   <%= hidden_field_tag :product_id, @product_id %>
   <%= hidden_field_tag :product_name, @product_name %>
   <%= hidden_field_tag :total_stock, @total_stock %>
   
<% end %>
</div>


<%# Top Customers Display %>
<div class="form-group col-xs-offset-5" style="margin-top:50px;">
<%= form_tag({:action => "summary"}, {:method => "get"}) do %>
  
   <%= render "partials/cust_style_filter" %>
   <%= render "partials/staff_filter" %>

   <%= hidden_field_tag :product_id, @product_id %>
   <%= hidden_field_tag :product_name, @product_name %>
   
   <%= submit_tag "Filter", class: 'btn btn-primary' %>
<% end %>
</div>

<table class = "table table-striped table-bordered table-hover table-responsive">
	<tr class="info">
		<th>Customer <%= render "partials/sort_arrows", order: 'order_by_name' %></th>
		<th>Staff <%= render "partials/sort_arrows", order: 'order_by_staff' %></th>
		<th>Channel <%= render "partials/sort_arrows", order: 'order_by_style' %></th>
		<% @time_periods.each do |t| %>
			<th><%= t %><%= render "partials/sort_arrows", order: t %></th>
		<% end %>
	</tr>

	<% @customer_ids.each do |id| %>
	<tr>
		<td><%= customer_name(@top_customers[id]) %></td>
		<td><%= @top_customers[id].staff.nickname %></td>
		<td><%= @top_customers[id].cust_style.name %></td>
		<% @time_periods.each do |t| %>
			<td><%= exists_in_h(@top_customers_timeperiod_h[t], id) %></td>
		<% end %>
	</tr>
	<% end %>

</table>