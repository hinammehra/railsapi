$('div[aria-label="calendar_radio"] label').change(function(){
  <%unless @calendar_staff.nil? %>
    // monthly / weekly
    if (this.children().val() == 'monthly'){
      $('#calendar_table').html('<%=j render 'calendar_partials/monthly_calendar', staff_id: @calendar_staff %>');
    else
      $('#calendar_table').html('<%=j render 'calendar_partials/weekly_calendar', staff_id: @calendar_staff %>');
  <% end %>
});

$("#event_checkbox").click(function(){
  if ($(this).is(':checked')){
    handler.removeMarkers(event_markers);
    event_markers = null;
    <%unless @calendar_staff.nil? %>
      if ($('div[aria-label="calendar_radio"] label.active input').val() == "monthly")
        event_markers = handler.addMarkers(<%=raw @event_hash.select{|x| ([x[:creator].to_s, x[:participant].to_s].include? @calendar_staff) && (@start_date.beginning_of_month == x[:date].beginning_of_month)}.to_json %>);
      else
        event_markers = handler.addMarkers(<%=raw @event_hash.select{|x| ([x[:creator].to_s, x[:participant].to_s].include? @calendar_staff) && (@start_date.beginning_of_week == x[:date].beginning_of_week)}.to_json %>);
    <% end %>
  }else{
    handler.removeMarkers(event_markers);
    event_markers = null;
  };
});

$("#customer_checkbox").click(function(){
  if ($(this).is(':checked')){
    handler.removeMarkers(customer_markers);
    customer_markers = null;
    <%unless @calendar_staff.nil? %>
      customer_markers = handler.addMarkers(<%=raw @hash.select{|x| x[:staff_id].to_s==@calendar_staff }.to_json%>);
    <% end %>
  }else{
    handler.removeMarkers(customer_markers);
    customer_markers = null;
  };
});

$(".calendar-date").click(function(){
  <%
    selected_date = @selected_date || Date.today.to_s
  %>
  handler.removeMarkers(event_markers);
  event_markers = null;
  event_markers = handler.addMarkers(<%=raw @event_hash.select{|x| ([x[:creator].to_s, x[:participant].to_s].include? @calendar_staff) && ((Date.parse selected_date) == x[:date].to_date)}.to_json %>);
});
