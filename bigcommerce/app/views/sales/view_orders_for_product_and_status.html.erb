<h3><center><%= @page_header %></center></h3><br/>

<table class = "table table-bordered table-hover table-responsive" style="width:50%;" align="center">
	<tr>
		<th>Number of Orders</th>
		<th>Qty</th>
		<th><%= @status_name %> Qty</th>
		<th>Total Qty</th>
		<th>Invoice Totals</th>
	</tr>
	<tr>
		<td class="num"><%= @num_orders %></td>
		<td class="num"><%= @qty %></td>
		<td class="num"><%= @status_qty %></td>
		<td class="num"><%= @status_qty.to_i + @qty.to_i %></td>
		<td class="num"><%= number_with_delimiter(number_with_precision(@total, precision: 2)) %></td>
</table>
<br/><br/>

<table class = "table table-striped table-bordered table-hover table-responsive">
	<tr class="info">
		<th></th>
		<% @time_periods.each do |t| %>
			<th><%= t.name %></th>
		<% end %>
	</tr>

	<tr>
		<td>Total Qty</td>
		<% @product_stats_sum.each do |s| %>
			<td><%= number_with_delimiter(number_with_precision(s, precision: 2)) %></td>
		<% end %>
	</tr>
	<tr>
		<td><%= @average_time_specified.name %> Average</td>
		<% @product_stats_avg.each do |a| %>
			<td><%= number_with_delimiter(number_with_precision(a, precision: 2)) %></td>
		<% end %>
	</tr>	

</table><br/><br/>

<div class="form-group" style="margin-left:550px;">
<%= form_tag({:action => "view_orders_for_product_and_status"}, {:method => "get"}) do %>
   <div class="col-xs-3">
   <%= collection_select(:staff, :id, @staffs, :id, :nickname, {:include_blank => 'All Staff'}, {:class => 'form-control'}) %>
   </div>
   <%= hidden_field_tag :product_id, @product_id %>
   <%= hidden_field_tag :product_name, @product_name %>
   <%= hidden_field_tag :status_name, @status_name %>
   <%= hidden_field_tag :status_id, @status_id %>
   <%= hidden_field_tag :num_orders, @num_orders %>
    <%= hidden_field_tag :qty, @qty %>
   <%= hidden_field_tag :status_qty, @status_qty %>
   <%= hidden_field_tag :total, @total %>
   <%= submit_tag "Filter", class: 'btn btn-primary' %>
<% end %>
</div>
<table class = "table table-striped table-bordered table-hover table-responsive">
	<tr>
		<th>Sales Rep</th>
		<th>Date</th>
		<th>Order Id</th>
		<th>Customer</th>
		<th>Status</th>
		<th>Product Qty</th>
		<th>Qty</th>
		<th>Order Total</th>
	</tr>

	<% @orders.each do |o| %>

		<tr>
			<td><%= o.customer.staff.nickname %></td>
			<td><%= o.date_created.to_date %></td>
			<td><%= link_to o.id, action: "view_products_for_orderid", order_id: o.id %></td>
			<td><%= link_to get_customer_name(o.customer), action: "view_orders_for_customer", customer_id: o.customer.id %></td>
			<td><%= @status_name %></td>
			<td class="num"><%= o.order_products.first.qty %></td>
			<td class="num"><%= o.qty %></td>
			<td class="num"><%= number_with_delimiter(number_with_precision(o.total_inc_tax, precision: 2)) %></td>
		</tr>

	<% end %>

</table>
