<div class="dropdown" style="float:left;">
	<button class="button dropdown-toggle" type="button" data-toggle="dropdown">Change Status
	<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <% @all_statuses.each do |s| %>

      	  <li class="center"><%= link_to s.name, action: "view_orders_by_status", status_id: s.id, status_name: s.name %></li>

      <% end %>
    </ul>
</div>

<div style="float:right;">
	<button class="button not-default inline orders-view" id="orders-view-button">Orders View</button>
	<button class="button default inline products-view" id="products-view-button">Products View</button>
</div>
<br/><br/>
<div class="form-group" style="margin-top:100px;">
<%= form_tag({:action => "view_orders_by_status"}, {:method => "get"}) do %>
   <div class="col-xs-3 col-xs-offset-1">
       <%= text_field_tag('search', @search_text, placeholder: 'Search for Product Name', class: 'form-control') %>
   </div>
   <div class="col-xs-2">
       <%= collection_select(:producer_country, :id, @countries, :id, :name, {:include_blank => 'All Countries'}, {:class => 'form-control'}) %>
   </div>   
   <div class="col-xs-2">
       <%= collection_select(:product_sub_type, :id, @sub_types, :id, :name, {:include_blank => 'All Varietals'}, {:class => 'form-control'}) %>
   </div>  
   <div class="col-xs-2">
       <%= collection_select(:staff, :id, @staffs, :id, :nickname, {:include_blank => 'All Sales Reps'}, {:class => 'form-control'}) %>
   </div>   
   <%= hidden_field_tag :status_id, @status_id %>
   <%= hidden_field_tag :status_name, @status_name %>
   <%= submit_tag "Filter", class: 'btn btn-primary' %>
   <button class = "btn btn-primary"><%= link_to "Reset", action: "view_orders_by_status" %></button>
<% end %>
</div>

<h3 id="orders-view-heading" class="orders-view not-default"><%= @page_header_orders %></h3><br/>

<table class = "table table-striped table-bordered table-hover table-responsive orders-view not-default" id = "orders-view-table">
	<tr>
		<th>Sales Rep</th>
		<th>Date</th>
		<th>Order Id</th>
		<th>Customer</th>
		<th>Status</th>
		<th>Qty</th>
		<th>Total</th>
	</tr>

	<% @orders.each do |o| %>

		<tr>

			<td class = "text"><%= o.customer.staff.nickname if !o.customer.nil? %></td>
			<td class = "text"><%= o.date_created.to_date %></td>
			<td class = "num"><%= link_to o.id, action: "view_products_for_orderid", order_id: o.id %></td>
			<td class = "text"><%= link_to get_customer_name(o.customer), action: "view_orders_for_customer", customer_id: o.customer_id %></td>
			<td class = "text"><%= link_to @status_name, action: "view_orders_by_status", status_id: @status_id, status_name: @status_name %></td>
			<td class = "num"><%= o.qty %></td>
			<td class = "num"><%= number_with_delimiter(number_with_precision(o.total_inc_tax, precision: 2)) %></td>

		</tr>

	<% end %>

</table>

<h3 id="products-view-heading" class="products-view default" style="text-align: center;"><%= @page_header_products %></h3><br/>

<table class = "table table-striped table-bordered table-hover table-responsive products-view" id = "products-view-table default">

	<tr>
		<th>Product Name</th>
		<th>Number of Orders</th>
		<th>Qty</th>
		<th><%= @status_name %> Qty</th>
		<th>Total Qty</th>
		<th>Invoice Totals</th>
	</tr>

	<% @product_map_sorted.each do |k,v| %>

		<tr>

			<td><%= link_to v[3], action: "view_orders_for_product_and_status", product_id: k, product_name: v[3], status_id: @status_id, status_name: @status_name, num_orders: v[0], qty: v[4], status_qty: v[1], total: v[2] %></td>
			<td class="num"><%= number_with_delimiter(v[0]) %></td>
			<td class="num"><%= number_with_delimiter(v[4]) %></td>
			<td class="num"><%= number_with_delimiter(v[1]) %></td>
			<td class="num"><%= number_with_delimiter(v[1] + v[4]) %></td>
			<td class="num"><%= number_with_delimiter(number_with_precision(v[2], precision: 2)) %></td>


		</tr>	

	<% end %>


</table>
